# 微博开放平台 API 调研报告

**调研日期**: 2025-01-05  
**调研人员**: AI Assistant  
**文档版本**: 1.0

## 1. 平台基本信息

- **平台名称**: 微博开放平台
- **官方文档地址**: https://open.weibo.com/wiki/
- **API版本**: OAuth 2.0
- **最后更新**: 2024-11-21（根据文档页面显示）

## 2. 认证方式

### 2.1 OAuth 流程
- **OAuth版本**: OAuth 2.0
- **授权码模式**: 支持
- **授权URL**: 
  - 完整URL: `https://api.weibo.com/oauth2/authorize?client_id=YOUR_CLIENT_ID&response_type=code&redirect_uri=YOUR_REGISTERED_REDIRECT_URI`
  - 接口路径: `oauth2/authorize`
- **Token获取**: 
  - 完整URL: `https://api.weibo.com/oauth2/access_token?client_id=YOUR_CLIENT_ID&client_secret=YOUR_CLIENT_SECRET&grant_type=authorization_code&redirect_uri=YOUR_REGISTERED_REDIRECT_URI&code=CODE`
  - 接口路径: `oauth2/access_token`
- **Token查询**: `oauth2/get_token_info` - 查询用户access_token的授权相关信息
- **Token类型**: Bearer Token
- **API调用方式**: 
  - 方式1：直接使用参数，传递参数名为 `access_token`
  - 方式2：在header里传递，形式为 `Authorization:OAuth2 {access_token}`
- **Token刷新机制**: 支持（仅移动应用SDK，使用refresh_token）
- **授权回收**: `oauth2/revokeoauth2` - 授权回收接口，帮助开发者主动取消用户的授权
- **OAuth版本升级**: `oauth2/get_oauth2_token` - OAuth1.0的Access Token更换至OAuth2.0的Access Token
- **授权级别**: 
  - 测试级别：未过审核的应用，授权有效期1天
  - 普通级别：已过审核的应用，授权有效期30天

### 2.2 Token管理
- **Access Token有效期**: 
  - 测试级别应用：1天
  - 普通级别应用：30天
  - 开发者自身授权：5年
- **Refresh Token有效期**: 30天（仅移动应用SDK支持）
- **Token刷新机制**: 
  - 仅使用微博官方移动SDK的移动应用可以获取Refresh Token
  - Refresh Token有效期30天，在有效期内可以刷新
  - 刷新后的Access Token有效期等同于原来的有效期（30天）
- **Token存储要求**: 建议加密存储
- **Token失效原因**:
  - 用户取消了对应用的授权
  - access_token自然过期
  - 用户修改了密码，冻结了对应用的授权
  - 微博发现用户账号被盗，冻结了用户对应用的授权

## 3. API能力

### 3.1 内容发布接口
- **接口地址**: 
  - `statuses/share` - 第三方分享链接到微博（写入接口）
    - URL: `https://api.weibo.com/2/statuses/share.json`
    - 功能：分享一条链接到微博
    - 文本限制：不超过140个汉字，必须包含至少一个第三方分享到微博的网页URL
    - 图片支持：可选，仅支持JPEG、GIF、PNG图片，上传图片大小限制为<5M
    - 编码方式：有上传图片时需要采用multipart/form-data编码方式
    - 访问级别：普通接口
    - 频次限制：是（发微博接口单授权用户每小时只能请求30次）
  - 其他发布接口（发布纯文字、图片、视频）需要查阅详细文档
- **支持的内容类型**: 文字、图片（最多9张）、视频
- **请求方法**: POST
- **文字长度限制**: 
  - `statuses/share` 接口：140个汉字（必须包含URL）
  - 其他发布接口：需要进一步确认（可能支持2000字）
- **图片数量限制**: 9张（需要进一步确认）
- **图片大小限制**: <5M
- **响应格式**: JSON
- **接口类型**: 写入接口（需要用户授权）

### 3.2 数据获取接口
- **用户信息接口**: 
  - `users/show` - 授权之后获取用户信息
  - `users/domain_show` - 授权之后通过个性域名获取用户信息
- **内容数据接口**: 
  - `statuses/home_timeline` - 获取当前授权用户及其所关注用户的最新微博
  - `statuses/user_timeline` - 获取授权用户发布的微博
  - `statuses/show` - 根据ID获取单条微博信息
  - `statuses/count` - 批量获取指定微博的转发数评论数
  - `statuses/mentions` - 获取@当前授权用户的最新微博
- **评论接口**: 
  - `comments/show` - 获取某条微博的评论列表
  - `comments/mentions` - 获取@到我的评论
- **统计数据接口**: 
  - `account/rate_limit_status` - 获取当前授权用户API访问频率限制
- **其他接口**: 
  - `emotions` - 获取官方表情
  - `statuses/go` - 根据ID跳转到单条微博页

### 3.3 用户管理接口
- **获取用户信息**: 
  - `users/show` - 授权之后获取用户信息
  - `users/domain_show` - 授权之后通过个性域名获取用户信息
  - `account/get_uid` - 授权之后获取用户的UID
  - `account/profile/email` - 授权之后获取用户的联系邮箱（需要高级接口申请和Scope权限）
- **关注/取消关注**: 需要查阅详细API文档确认
- **其他用户操作**: 需要查阅完整API文档

## 4. 限制条件

### 4.1 API调用频率限制
- **限制规则**: 
  - 一个应用内单授权用户每天累计只能请求微博开放接口 **100次**
  - 一个IP地址每小时只能请求微博开放接口 **15000次**
  - 发微博接口单授权用户每小时只能请求 **30次**
  - 限制的单位时间：每小时、每天
  - 限制的维度：单授权用户、单IP
  - 部分特殊接口有单独的请求次数限制
- **限制周期**: 每小时、每天
- **超出限制处理**: 返回错误信息，可能导致应用或IP被封禁
- **查询接口**: `account/rate_limit_status` - 获取当前授权用户API访问频率限制
  - URL: `https://api.weibo.com/2/account/rate_limit_status.json`
  - 返回示例：`{ "ip_limit": 10000, "limit_time_unit": "HOURS", "remaining_ip_hits": 10000, "remaining_user_hits": 150, "reset_time": "2011-06-03 18:00:00", "reset_time_in_seconds": 1415, "user_limit": 150 }`
- **测试账号限制**: 
  - 未通过审核的应用只能授权15个测试账号来请求接口
  - 测试账号发布的内容只有测试账号可见，不会实际分发到非测试账号的内容流里
- **建议**: 
  - 更新频率建议3-5分钟/次为宜
  - 基于用户主动行为正常访问接口
  - 避免机器人程序或非用户主动行为频繁调用

### 4.2 内容限制
- **文字长度限制**: 
  - `statuses/share` 接口：140个汉字（必须包含URL）
  - 其他发布接口：需要进一步确认（可能支持2000字）
- **图片数量限制**: 9张（需要进一步确认）
- **图片大小限制**: <5M（JPEG、GIF、PNG格式）
- **图片格式**: 仅支持JPEG、GIF、PNG图片
- **视频大小限制**: 需要进一步确认
- **其他限制**: 
  - `statuses/share` 接口：文本中不能包含"#话题词#"
  - `statuses/share` 接口：必须包含至少一个第三方分享到微博的网页URL，且该URL只能是该第三方（调用方）绑定域下的URL链接
  - 需要在"我的应用 － 应用信息 － 基本应用信息编辑 － 安全域名"里设置绑定域

### 4.3 权限限制
- **高级接口**: 标识为"高级接口申请"的接口需要申请才可以调用
- **Scope权限**: 标识为"Scope"的接口需要单独向用户提出SCOPE授权请求，用户单独授权后才可以调用
- **权限申请流程**: 
  - 高级接口：需要在开放平台申请（详见高级接口申请页面）
  - Scope权限：需要在授权时请求相应的Scope权限
- **示例**: `account/profile/email` 接口需要高级接口申请和Scope权限

## 5. 开发者认证要求

### 5.1 注册要求
- **个人开发者**: ✅ **支持**（微博开放平台明确支持个人开发者注册）
- **企业开发者**: ✅ 支持
- **注册流程**: 
  1. 访问微博开放平台 https://open.weibo.com/
  2. 注册开发者账号（个人或企业）
  3. 创建应用
  4. 获取 App Key 和 App Secret
  5. 完成应用审核（个人开发者审核相对简单）

### 5.2 认证要求
- **身份验证**: 需要实名认证
- **认证材料**: 需要提交身份证明（个人开发者）
- **认证时间**: 需要进一步确认

### 5.3 费用说明
- **免费额度**: 需要进一步确认
- **付费方案**: 需要进一步确认
- **费用标准**: 需要查阅官方文档

## 6. 接入成本评估

### 6.1 技术复杂度
- **接入难度**: 中等
- **开发工作量**: 预估 1-2 周（基于OAuth 2.0标准流程）

### 6.2 维护成本
- **API稳定性**: 稳定（微博是成熟平台）
- **文档更新频率**: 定期更新（最后更新 2024-11-21）
- **技术支持**: 提供开发者文档和社区支持

### 6.3 推荐程度
- **推荐接入**: ✅ **强烈推荐**
- **推荐理由**: 
  - ✅ **明确支持个人开发者**（无需企业认证）
  - 文档相对完整
  - OAuth 2.0 标准流程
  - 平台稳定，用户基数大
  - 免费额度相对宽松（需要进一步确认具体数值）
  - 接入成本较低
- **不推荐原因**: 无

## 7. 注意事项

- **重要提示**: 
  - 需要仔细阅读微博开放平台的开发者协议
  - 需要遵守平台的内容规范
  - API调用需要遵守频率限制
- **常见问题**: 
  - OAuth 2.0 授权流程需要正确实现
  - Token 需要妥善保管和刷新
- **最佳实践**: 
  - 使用官方SDK可以简化开发
  - 实现Token自动刷新机制
  - 处理API调用频率限制

## 8. 参考资料

- **官方文档**: https://open.weibo.com/wiki/
- **API参考**: https://open.weibo.com/wiki/API
- **SDK下载**: https://open.weibo.com/wiki/SDK
- **社区支持**: 微博开放平台官微 @微博开放平台

## 9. 待确认信息

以下信息需要进一步调研和确认：

- [x] 个人开发者是否完全支持（无企业认证要求）✅ **已确认支持**
- [x] Access Token 和 Refresh Token 的具体有效期 ✅ **已确认**
  - Access Token: 测试1天，普通30天，开发者5年
  - Refresh Token: 30天（仅移动SDK）
- [x] API调用频率限制的具体数值 ✅ **已确认**
  - 单授权用户每天：100次
  - 单IP每小时：15000次
  - 发微博接口单授权用户每小时：30次
- [ ] 视频发布接口的具体参数和限制
- [ ] 免费额度和付费方案的具体信息（可通过商业开放平台 https://openapi.sc.weibo.com/ 了解）
- [ ] 认证审核的具体时长
- [ ] 发布微博的完整接口（statuses/share 是分享链接，需要确认发布纯文字/图片/视频的其他接口）
- [ ] 图片数量限制的具体数值（是否支持9张）

## 10. 下一步行动

1. 访问微博开放平台的完整API文档，获取详细的接口说明
2. 注册开发者账号，验证个人开发者注册流程
3. 测试API调用，验证实际限制条件
4. 完成待确认信息的调研
